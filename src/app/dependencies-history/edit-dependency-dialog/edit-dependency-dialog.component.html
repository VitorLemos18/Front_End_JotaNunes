<div class="edit-dependency-container">
  <h2 mat-dialog-title>
    <lucide-angular name="edit-3" class="icon"></lucide-angular>
    Editar Dependência
  </h2>

  <mat-dialog-content class="dialog-content">
    <!-- BLOCO DE ORIGEM -->
    <div class="block">
      <div class="form-group">
        <label>Tabela de Origem</label>
        <mat-form-field appearance="outline" class="select-field">
          <mat-select [(ngModel)]="selectedSourceTable" (selectionChange)="onSourceTableChange()" placeholder="Selecione" panelClass="dependencies-select-panel" [disableOptionCentering]="true">
            <mat-option *ngFor="let table of tables" [value]="table">{{ table }}</mat-option>
          </mat-select>
        </mat-form-field>
      </div>

      <!-- Registro de Origem -->
      <div class="form-group" *ngIf="selectedSourceTable">
        <label>Registro de Origem</label>
        <button mat-stroked-button color="primary" (click)="openModal('origem')">
          {{ selectedSourceRecord ? selectedSourceRecord.name : 'Selecionar Registro' }}
        </button>
      </div>
    </div>

    <!-- BLOCO DE DESTINO -->
    <div class="block" *ngIf="selectedSourceRecord">
      <hr />

      <div class="form-group">
        <label>Tabela de Destino</label>
        <mat-form-field appearance="outline" class="select-field">
          <mat-select [(ngModel)]="selectedTargetTable" (selectionChange)="onTargetTableChange()" placeholder="Selecione" panelClass="dependencies-select-panel" [disableOptionCentering]="true">
            <mat-option *ngFor="let table of tables" [value]="table">{{ table }}</mat-option>
          </mat-select>
        </mat-form-field>
      </div>

      <!-- Registros de Destino -->
      <div class="form-group" *ngIf="selectedTargetTable">
        <label>Registros de Destino</label>
        <div class="destination-list" *ngIf="selectedTargetRecords.length > 0">
          <div class="destination-item" *ngFor="let record of selectedTargetRecords">
            {{ record.name }}
            <button mat-icon-button color="warn" (click)="removeTargetRecord(record)" class="remove-btn">
              <lucide-angular name="x"></lucide-angular>
            </button>
          </div>
        </div>
        <button mat-stroked-button color="primary" (click)="openModal('destino')">
          {{ selectedTargetRecords.length > 0 ? 'Adicionar Mais Registros' : 'Selecionar Registros' }}
        </button>
      </div>
    </div>

    <!-- PRIORIDADE -->
    <div class="block" *ngIf="selectedTargetRecords.length > 0">
      <div class="form-group">
        <label>Prioridade</label>
        <mat-form-field appearance="outline" class="select-field">
          <mat-select [(ngModel)]="selectedPrioridade" placeholder="Selecione a prioridade" panelClass="dependencies-select-panel" [disableOptionCentering]="true">
            <mat-option [value]="null">Sem Prioridade</mat-option>
            <mat-option *ngFor="let prioridade of prioridades" [value]="prioridade">
              {{ prioridade }}
            </mat-option>
          </mat-select>
        </mat-form-field>
      </div>
    </div>
  </mat-dialog-content>

  <mat-dialog-actions align="end">
    <button mat-button (click)="cancel()">Cancelar</button>
    <button mat-raised-button color="primary" (click)="saveDependency()" 
            [disabled]="!selectedSourceRecord || selectedTargetRecords.length === 0">
      Salvar Alterações
    </button>
  </mat-dialog-actions>
</div>


